name: Create Issue on Push

on:
  push:
    branches: [ main ]

jobs:
  create-issue:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Create Issue
      id: create-issue
      run: |
        echo "Push event detected. Creating an issue..."
        body="Push event detected by GitHub Actions."
        title="Push Event on Branch: ${{ github.ref }}"
        echo "Title: $title"

        
        issue_url=$(curl --request POST \
          --url https://api.github.com/repos/${{ github.repository }}/issues \
          --header 'authorization: Bearer ${{ secrets.GITHUB_TOKEN }}' \
          --header 'content-type: application/json' \
          --data '{
            "title": "'"$title"'",
            "body": ""This issue was automatically created by the GitHub Action workflow **${{ github.workflow }}**. \n\n The commit hash was: _${{ github.sha }}_.""
          }' \
          --fail

        echo "Issue created: $issue_url"
        

      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
